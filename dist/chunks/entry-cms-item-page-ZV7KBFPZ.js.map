{
  "version": 3,
  "sources": ["../../src/pages/entries (single)/entry-cms-item-page.ts"],
  "sourcesContent": ["import { isPage } from '$utils/is-page';\n\nconst CMS_LIST_SELECTOR = '[custom_action=\"cms_list\"]';\nconst WEBFLOW_LIST_WRAPPER = '.w-dyn-list';\n\n/**\n * Webflow can split a Collection List into multiple .w-dyn-list blocks (e.g. pagination chunks).\n * Merges all cms_list containers into the first one so ordering and next/prev use a single combined list.\n */\nconst mergeCMSLists = (): HTMLElement | null => {\n  const lists = Array.from(document.querySelectorAll(CMS_LIST_SELECTOR)) as HTMLElement[];\n  if (lists.length <= 1) return lists[0] ?? null;\n\n  const [primary, ...rest] = lists;\n  rest.forEach((list) => {\n    while (list.firstElementChild) {\n      primary.appendChild(list.firstElementChild);\n    }\n    const wrapper = list.closest(WEBFLOW_LIST_WRAPPER);\n    if (wrapper instanceof HTMLElement) {\n      wrapper.style.display = 'none';\n    }\n  });\n  return primary;\n};\n\n/**\n * Orders the winner CMS list for next/previous navigation.\n * List should be ordered by category and then position within category.\n */\nconst orderWinnerCMSList = () => {\n  if (!isPage(['/winners/*'])) return;\n\n  const SELECTORS = {\n    CMS_LIST: CMS_LIST_SELECTOR,\n    CMS_CATEGORY: 'cms-category',\n    CMS_POSITION: 'cms-position',\n  };\n\n  const cmsList = document.querySelector(SELECTORS.CMS_LIST) as HTMLElement;\n\n  if (!cmsList) {\n    console.error('CMS list not found');\n    return;\n  }\n\n  const items = Array.from(cmsList.children);\n\n  // Sort items by category and position\n  const sortedItems = items.sort((a, b) => {\n    const categoryA = a.getAttribute(SELECTORS.CMS_CATEGORY) || '';\n    const categoryB = b.getAttribute(SELECTORS.CMS_CATEGORY) || '';\n    const positionA = parseInt(a.getAttribute(SELECTORS.CMS_POSITION) || '0', 10);\n    const positionB = parseInt(b.getAttribute(SELECTORS.CMS_POSITION) || '0', 10);\n\n    // First compare categories\n    if (categoryA !== categoryB) {\n      return categoryA.localeCompare(categoryB);\n    }\n    // If categories are the same, compare positions\n    return positionA - positionB;\n  });\n\n  // Reorder DOM elements\n  sortedItems.forEach((item) => {\n    cmsList.appendChild(item);\n  });\n\n  console.log('Sorted items:', sortedItems);\n};\n\nconst entryCMSItemPage = () => {\n  console.log('Initializing entry page navigation');\n\n  const list = mergeCMSLists();\n  if (!list) {\n    console.error('CMS list not found');\n    return;\n  }\n\n  orderWinnerCMSList();\n\n  const nextButton = document.querySelector('[custom_action=\"btn_next_cms\"]') as HTMLAnchorElement;\n  const prevButton = document.querySelector('[custom_action=\"btn_prev_cms\"]') as HTMLAnchorElement;\n\n  if (!nextButton || !prevButton) {\n    console.error('CMS elements missing - ', { list, nextButton, prevButton });\n    return;\n  }\n\n  // Get all list items safely\n  const pathnames = Array.from(list.querySelectorAll('a'))\n    .map((link) => link.pathname)\n    .filter(Boolean); // Remove any undefined or null values\n\n  const currentPath = window.location.pathname;\n  const currentIndex = pathnames.indexOf(currentPath);\n\n  const addPreloadLink = (path: string) => {\n    try {\n      const link = document.createElement('link');\n      link.rel = 'prefetch'; // Changed from preload to prefetch\n      link.href = path;\n      link.type = 'text/html'; // Specify content type\n\n      // Check if link already exists to avoid duplicates\n      const existingLink = document.querySelector(`link[href=\"${path}\"]`);\n      if (!existingLink) {\n        document.head.appendChild(link);\n      }\n    } catch (error) {\n      console.error('Error adding preload link:', error);\n    }\n  };\n\n  if (currentIndex === 0 && prevButton) {\n    prevButton.style.display = 'none';\n  } else if (prevButton && currentIndex > 0) {\n    const prevPath = pathnames[currentIndex - 1];\n    prevButton.href = prevPath;\n    addPreloadLink(prevPath);\n  }\n\n  // Hide next button if at the last item\n  if (currentIndex === pathnames.length - 1 && nextButton) {\n    nextButton.style.display = 'none';\n  } else if (nextButton && currentIndex >= 0 && currentIndex < pathnames.length - 1) {\n    const nextPath = pathnames[currentIndex + 1];\n    nextButton.href = nextPath;\n    addPreloadLink(nextPath);\n  }\n};\n\nexport { entryCMSItemPage };\n"],
  "mappings": "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",
  "names": []
}
