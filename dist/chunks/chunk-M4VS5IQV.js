import{a as r}from"./chunk-DCW6JJXJ.js";import{c as v}from"./chunk-NDOT7LF6.js";var f={phaseID:"data-phase-slug",endDate:"data-phase-date"},m={nav:{phaseList:'[data-phase-element="nav-list"]',timer:'[data-phase-element="nav-timer"]',countdownMessage:'[data-phase-element="nav-countdown-message"]',messageWrapper:'[data-phase-element="nav-message-wrapper"]',ctaButton:'[data-phase-element="nav-cta-button"]'},banner:{phaseList:'[data-phase-element="banner-list"]',timer:'[data-phase-element="banner-timer"]',countdownMessage:'[data-phase-element="banner-countdown-message"]',messageWrapper:'[data-phase-element="banner-message-wrapper"]'}},u={controlItem:'[data-phase-element="control"]',showAll:'[data-phase-control="show-all"]',activePhase:"data-phase-active"},l={row:'[banner-marquee-element="row"]',item:'[banner-marquee-element="item"]',initializedAttr:"data-marquee-initialized"},d=!1,M,p=e=>{let t=new Date,a=e.getTime()-t.getTime();return a<=0?null:{days:Math.floor(a/(1e3*60*60*24)),hours:Math.floor(a%(1e3*60*60*24)/(1e3*60*60)),minutes:Math.floor(a%(1e3*60*60)/(1e3*60)),seconds:Math.floor(a%(1e3*60)/1e3)}},y=e=>{let{days:t,hours:a}=e;return`${t}d ${a}h.`},P=(e,t)=>{e.style.display=t},T=e=>{if(!e)return null;let t=new Date(e);return isNaN(t.getTime())?null:t},R=()=>{let e=document.querySelector(m.nav.phaseList);e&&P(e,"block")},A=e=>{let t=e.querySelector(m.nav.messageWrapper),a=e.querySelector(m.nav.ctaButton);R(),r.fromTo(a,{opacity:0,x:0},{opacity:1,x:0,duration:.3,ease:"power2.out",display:"block",delay:.3}),r.fromTo(t,{opacity:0,x:20,y:0},{opacity:1,x:0,y:0,duration:.5,ease:"power2.out",delay:.4})},S=e=>{e.style.flexShrink="0",e.style.whiteSpace="nowrap";let t=e.getBoundingClientRect().width+2;return t>0&&(e.style.width=`${t}px`),t},C=(e,t,a)=>{let n=window.innerWidth,s=Math.min(Math.ceil(n*2/a)+2,20);for(let i=0;i<s-1;i++){let c=t.cloneNode(!0);c.style.width=`${a}px`,e.appendChild(c)}},L=(e,t)=>{r.killTweensOf(e),r.killTweensOf(e.children),r.set(e.children,{opacity:0}),r.set(e,{opacity:0,x:0}),r.to(e.children,{opacity:1,duration:.3,ease:"power2.out"}),r.fromTo(e,{opacity:0,x:0,y:-20},{opacity:1,x:-t,y:0,duration:.3,ease:"power2.out"}),r.to(e,{x:-t,duration:45,ease:"none",repeat:-1,repeatDelay:0,immediateRender:!0,delay:.1})},E=e=>{e.querySelectorAll(l.item).forEach(a=>{let n=a.getAttribute(f.endDate),o=T(n);if(!o)return;let s=a.querySelector(m.banner.timer);if(!s)return;let i=p(o);i?s.textContent=y(i):s.textContent="Completed"})},D=e=>{let t=setInterval(()=>{E(e)},1e3);e._timerInterval=t},h=e=>{e._timerInterval&&(clearInterval(e._timerInterval),delete e._timerInterval)},x=()=>{if(!v()){document.querySelectorAll(l.row).forEach(a=>{r.set(a,{opacity:0}),r.set(a.children,{opacity:0}),h(a)});return}let e=document.querySelectorAll(l.row);e.length&&e.forEach(t=>{if(t.hasAttribute(l.initializedAttr))return;h(t),r.set(t,{opacity:0}),r.set(t.children,{opacity:0});let a=t.querySelector(l.item);if(!a)return;let n=S(a);n!==0&&(C(t,a,n),E(t),D(t),t.setAttribute(l.initializedAttr,"true"),L(t,n))})},w=window.innerWidth,b=window.innerHeight,H=()=>{let e=window.innerWidth,t=window.innerHeight;if(e===w&&Math.abs(t-b)<300)return;w=e,b=t;let a=document.querySelectorAll(l.row);if(a.length){if(a.forEach(n=>{r.set(n,{opacity:0}),r.set(n.children,{opacity:0})}),!v()){a.forEach(n=>{h(n)});return}d||(d=!0,a.forEach(n=>{r.killTweensOf(n),r.killTweensOf(n.children)}),a.forEach(n=>{r.to(n,{opacity:0,duration:.2,onComplete:()=>{h(n),n.style.cssText="";let o=n.querySelector(l.item);if(!o){d=!1;return}let s=o.cloneNode(!0);s.style.cssText="",n.innerHTML="",n.appendChild(s),n.removeAttribute(l.initializedAttr);let i=S(s);if(i===0){d=!1;return}C(n,s,i),E(n),D(n),n.setAttribute(l.initializedAttr,"true"),L(n,i)}})}),setTimeout(()=>{d=!1},300))}},_=()=>()=>{clearTimeout(M),M=setTimeout(H,150)},O=(e,t)=>{let a=e.getAttribute(f.endDate),n=T(a),o=e.querySelector(t.countdownMessage);if(!n){A(e);return}let s=e.querySelector(t.timer);if(!s)return;let i=p(n);if(!i){s.textContent="Completed",o.style.display="none",A(e);return}s.textContent=y(i);let c=setInterval(()=>{let I=p(n);if(!I){clearInterval(c);return}s.textContent=y(I)},1e3);e._countdownInterval=c,A(e)},z=(e,t)=>{let a=e.getAttribute(f.endDate),n=T(a);if(!n)return;let o=e.querySelector(t.timer);if(!o)return;let s=e.querySelector(t.countdownMessage),i=e.querySelector(t.messageWrapper),c=p(n);if(!c){s&&(s.style.display="none"),i&&(i.style.display="block"),o.textContent="Completed";return}o.textContent=y(c)},g=e=>{e._countdownInterval&&(clearInterval(e._countdownInterval),delete e._countdownInterval)},q=e=>{let t=m[e.location],a=document.querySelector(t.phaseList);return a?(Array.from(a.children).forEach(g),Array.from(a.children).forEach(n=>{let o=n.getAttribute(f.phaseID),s=e.showAllPhases||e.activePhase&&o===e.activePhase;P(n,s?"flex":"none"),s&&(e.location==="nav"?O(n,t):z(n,t))}),{phaseList:a,activePhase:e.activePhase}):(console.error(`Phase list not found for ${e.location}`),null)},N=()=>{try{let e=document.querySelector(u.controlItem),t=!!e?.querySelector(u.showAll),a=e?.querySelector(`[${u.activePhase}]`)?.getAttribute(u.activePhase)??null,n=q({location:"nav",showAllPhases:t,activePhase:a}),o=q({location:"banner",showAllPhases:t,activePhase:a});x(),!n&&!o&&console.warn("Phase displays could not be initialized");let s=_();return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),n?.phaseList&&Array.from(n.phaseList.children).forEach(g),o?.phaseList&&Array.from(o.phaseList.children).forEach(g),document.querySelectorAll(l.row).forEach(h)}}catch(e){console.error("Error initializing phase control:",e)}},B=()=>{let e=document.querySelector(u.controlItem),t=!!e?.querySelector(u.showAll),a=e?.querySelector(`[${u.activePhase}]`)?.getAttribute(u.activePhase)??null;return{showAllPhases:t,activePhase:a}},$=()=>{N()};export{B as a,$ as b};
